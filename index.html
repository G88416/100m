<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Lotto Generator Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #5c6bc0;
            --primary-dark: #3949ab;
            --primary-light: #7986cb;
            --secondary: #26a69a;
            --dark: #2c3e50;
            --light: #f5f7fa;
            --accent: #7e57c2;
            --success: #66bb6a;
            --warning: #ffa726;
            --danger: #ef5350;
            --info: #42a5f5;
            --text-primary: #263238;
            --text-secondary: #546e7a;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --border-color: #e0e0e0;
        }

        [data-theme="dark"] {
            --primary: #7986cb;
            --primary-dark: #5c6bc0;
            --primary-light: #9fa8da;
            --secondary: #26a69a;
            --dark: #cfd8dc;
            --light: #37474f;
            --accent: #9575cd;
            --success: #81c784;
            --warning: #ffb74d;
            --danger: #e57373;
            --info: #64b5f6;
            --text-primary: #eceff1;
            --text-secondary: #b0bec5;
            --bg-color: #263238;
            --card-bg: #37474f;
            --border-color: #455a64;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-color);
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 2rem 0;
            text-align: center;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            position: relative;
        }

        h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 500;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 0.5rem;
            font-weight: 300;
        }

        .card {
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card h2 {
            color: var(--primary);
            margin-top: 0;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 0.5rem;
            font-weight: 500;
        }

        .tabs {
            display: flex;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 5px;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 5px 5px 0 0;
            transition: all 0.3s;
            font-weight: 500;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            background: var(--primary-light);
            color: white;
        }

        .tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .tab-content.active {
            display: block;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
            background: var(--card-bg);
            color: var(--text-primary);
            transition: border 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(92, 107, 192, 0.2);
        }

        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background-color: var(--text-secondary);
        }

        button.success {
            background-color: var(--success);
        }

        button.warning {
            background-color: var(--warning);
        }

        button.danger {
            background-color: var(--danger);
        }

        button.info {
            background-color: var(--info);
        }

        .result {
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--bg-color);
            border-radius: 4px;
            border-left: 4px solid var(--accent);
            color: var(--text-primary);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .lotto-balls {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
            align-items: center;
        }

        .ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .ball:hover {
            transform: scale(1.1);
        }

        .ball.powerball {
            background-color: var(--danger);
        }

        .ball.megaball {
            background-color: var(--info);
        }

        .ball.eurostar {
            background-color: var(--success);
        }

        .progress-container {
            width: 100%;
            background-color: var(--border-color);
            border-radius: 4px;
            margin: 1rem 0;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                -45deg,
                rgba(255, 255, 255, 0.2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, 0.2) 50%,
                rgba(255, 255, 255, 0.2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 30px 30px;
            animation: progressAnimation 1s linear infinite;
        }

        @keyframes progressAnimation {
            0% { background-position: 0 0; }
            100% { background-position: 30px 0; }
        }

        .status {
            margin: 1rem 0;
            padding: 0.75rem;
            border-radius: 4px;
            font-weight: 500;
        }

        .status.info {
            background-color: rgba(66, 165, 245, 0.1);
            border-left: 4px solid var(--info);
            color: var(--info);
        }

        .status.success {
            background-color: rgba(102, 187, 106, 0.1);
            border-left: 4px solid var(--success);
            color: var(--success);
        }

        .status.warning {
            background-color: rgba(255, 167, 38, 0.1);
            border-left: 4px solid var(--warning);
            color: var(--warning);
        }

        .status.error {
            background-color: rgba(239, 83, 80, 0.1);
            border-left: 4px solid var(--danger);
            color: var(--danger);
        }

        .algorithm-info {
            margin-top: 2rem;
            padding: 1rem;
            background-color: var(--bg-color);
            border-radius: 4px;
            border-left: 4px solid var(--accent);
        }

        .algorithm-info h3 {
            color: var(--secondary);
            margin-top: 0;
        }

        .code {
            font-family: 'Source Code Pro', monospace;
            background-color: var(--bg-color);
            padding: 0.5rem;
            border-radius: 4px;
            display: block;
            overflow-x: auto;
            margin: 0.5rem 0;
            border-left: 3px solid var(--accent);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--bg-color);
            font-weight: 500;
            color: var(--primary);
        }

        tr:hover {
            background-color: var(--bg-color);
        }

        /* Histogram styles */
        .histogram {
            display: flex;
            height: 200px;
            align-items: flex-end;
            gap: 2px;
            margin: 1rem 0;
            padding: 1rem 0;
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }

        .histogram-bar {
            flex: 1;
            background: linear-gradient(to top, var(--primary), var(--secondary));
            min-width: 5px;
            position: relative;
            transition: height 0.5s ease;
        }

        .histogram-bar-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Frequency table styles */
        .frequency-table {
            width: 100%;
            margin: 1rem 0;
        }

        .frequency-table th, .frequency-table td {
            padding: 8px;
            text-align: center;
        }

        .hot-number {
            background-color: rgba(239, 83, 80, 0.1);
            font-weight: bold;
        }

        .cold-number {
            background-color: rgba(66, 165, 245, 0.1);
            font-weight: bold;
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 100;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: normal;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Theme toggle */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(30deg);
        }

        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Action buttons container */
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-radius: 4px;
                margin-bottom: 5px;
            }
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Export buttons */
        .export-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Save/Load buttons */
        .config-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        /* Tab icons */
        .tab-icon {
            font-size: 0.9em;
        }
        
        /* Notification toast */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* Improved number input styling */
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        /* Better table styling */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .data-table th {
            background-color: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .data-table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .data-table tr:nth-child(even) {
            background-color: rgba(0,0,0,0.02);
        }
        
        .data-table tr:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        /* Strategy selector */
        .strategy-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .strategy-option {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .strategy-option:hover {
            background-color: var(--primary-light);
            color: white;
        }
        
        .strategy-option.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Number matrix */
        .number-matrix {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin: 1rem 0;
        }
        
        .number-cell {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .number-cell:hover {
            background-color: var(--primary-light);
            color: white;
        }
        
        .number-cell.selected {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Wheel visualization */
        .wheel-container {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
        }
        
        .wheel {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 5px solid var(--border-color);
        }
        
        .wheel-number {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        /* History table */
        .history-table {
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            <h1>Advanced Lotto Generator Pro</h1>
            <p class="subtitle">Advanced lottery number generation with multiple algorithms and strategies</p>
        </div>
    </header>
    
    <div class="container">
        <div class="tabs">
            <button class="tab active" data-tab="lotto-generate">
                <i class="fas fa-ticket-alt tab-icon"></i> Lotto Generator
            </button>
            <button class="tab" data-tab="lotto-analyzer">
                <i class="fas fa-chart-pie tab-icon"></i> Number Analyzer
            </button>
            <button class="tab" data-tab="history">
                <i class="fas fa-history tab-icon"></i> Draw History
            </button>
            <button class="tab" data-tab="strategies">
                <i class="fas fa-chess tab-icon"></i> Strategies
            </button>
        </div>
      
        <!-- Lotto Generator Tab -->
        <div id="lotto-generate" class="tab-content active">
            <div class="config-buttons">
                <button onclick="saveLottoConfig()" class="info">
                    <i class="fas fa-save"></i> Save Config
                </button>
                <button onclick="loadLottoConfig()" class="info">
                    <i class="fas fa-folder-open"></i> Load Config
                </button>
            </div>
            
            <div class="grid">
                <div>
                    <label for="lotto-game-type">Lottery Game:</label>
                    <select id="lotto-game-type">
                        <option value="powerball">Powerball (5/69 + 1/26)</option>
                        <option value="megamillions">Mega Millions (5/70 + 1/25)</option>
                        <option value="euromillions">EuroMillions (5/50 + 2/12)</option>
                        <option value="lotto649">Lotto 6/49</option>
                        <option value="custom">Custom Game</option>
                    </select>
                    
                    <div id="lotto-custom-params" style="display: none;">
                        <div class="grid">
                            <div>
                                <label for="lotto-main-numbers">Main Numbers Pool:</label>
                                <input type="number" id="lotto-main-numbers" min="1" value="69">
                            </div>
                            <div>
                                <label for="lotto-pick-numbers">Numbers to Pick:</label>
                                <input type="number" id="lotto-pick-numbers" min="1" value="5">
                            </div>
                        </div>
                        <div class="grid">
                            <div>
                                <label for="lotto-bonus-numbers">Bonus Numbers Pool:</label>
                                <input type="number" id="lotto-bonus-numbers" min="0" value="26">
                            </div>
                            <div>
                                <label for="lotto-pick-bonus">Bonus Numbers to Pick:</label>
                                <input type="number" id="lotto-pick-bonus" min="0" value="1">
                            </div>
                        </div>
                    </div>
                    
                    <label for="lotto-algorithm">Generation Algorithm:</label>
                    <select id="lotto-algorithm">
                        <option value="standard">Standard Random</option>
                        <option value="shuffle">Fisher-Yates Shuffle</option>
                        <option value="crypto">Cryptographically Secure</option>
                        <option value="low-high">Low-High Balance</option>
                        <option value="odd-even">Odd-Even Balance</option>
                        <option value="prime">Prime Numbers</option>
                        <option value="fibonacci">Fibonacci Numbers</option>
                        <option value="lucky">Lucky Numbers</option>
                        <option value="hot-cold">Hot & Cold Numbers</option>
                    </select>
                    
                    <div id="lotto-strategy-params" style="display: none;">
                        <label for="lotto-strategy">Number Selection Strategy:</label>
                        <select id="lotto-strategy">
                            <option value="random">Pure Random</option>
                            <option value="spread">Wide Spread</option>
                            <option value="cluster">Number Clusters</option>
                            <option value="sequential">Sequential Pairs</option>
                            <option value="multiple">Multiple of X</option>
                        </select>
                        
                        <div id="multiple-param" style="display: none;">
                            <label for="multiple-value">Multiple of:</label>
                            <input type="number" id="multiple-value" min="2" max="10" value="3">
                        </div>
                    </div>
                    
                    <label for="lotto-seed">Seed (leave empty for random):</label>
                    <input type="number" id="lotto-seed">
                    
                    <label for="lotto-draw-count">Number of draws:</label>
                    <input type="number" id="lotto-draw-count" min="1" value="5" max="1000">
                    
                    <div class="action-buttons">
                        <button onclick="generateLottoNumbers()" class="success">
                            <i class="fas fa-play"></i> Generate
                        </button>
                        <button onclick="clearLottoGeneration()" class="secondary">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                        <button onclick="randomizeLottoSeed()" class="info">
                            <i class="fas fa-dice"></i> Random Seed
                        </button>
                        <button onclick="quickPick()" class="warning">
                            <i class="fas fa-bolt"></i> Quick Pick
                        </button>
                    </div>
                </div>
                
                <div>
                    <label>Generated Numbers:</label>
                    <div id="lotto-generated-results"></div>
                    
                    <div class="export-buttons">
                        <button onclick="exportLottoNumbers('txt')" class="secondary">
                            <i class="fas fa-file-alt"></i> Export as TXT
                        </button>
                        <button onclick="exportLottoNumbers('csv')" class="secondary">
                            <i class="fas fa-file-csv"></i> Export as CSV
                        </button>
                        <button onclick="exportLottoNumbers('json')" class="secondary">
                            <i class="fas fa-file-code"></i> Export as JSON
                        </button>
                        <button onclick="copyLottoNumbers()" class="secondary">
                            <i class="fas fa-copy"></i> Copy to Clipboard
                        </button>
                    </div>
                    
                    <div class="result">
                        <strong>Generation Details:</strong>
                        <div id="lotto-gen-details"></div>
                    </div>
                    
                    <div id="lotto-frequency-analysis">
                        <h4>Frequency Analysis</h4>
                        <div id="lotto-frequency-content"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Number Analyzer Tab -->
        <div id="lotto-analyzer" class="tab-content">
            <div class="grid">
                <div>
                    <label for="analyzer-game-type">Lottery Game:</label>
                    <select id="analyzer-game-type">
                        <option value="powerball">Powerball (5/69 + 1/26)</option>
                        <option value="megamillions">Mega Millions (5/70 + 1/25)</option>
                        <option value="euromillions">EuroMillions (5/50 + 2/12)</option>
                        <option value="lotto649">Lotto 6/49</option>
                    </select>
                    
                    <label for="analyzer-numbers">Numbers to Analyze (comma separated):</label>
                    <input type="text" id="analyzer-numbers" placeholder="e.g. 5, 10, 15, 20, 25, 30">
                    
                    <button onclick="analyzeNumbers()" class="success">Analyze</button>
                    <button onclick="clearAnalyzer()" class="secondary">Clear</button>
                </div>
                
                <div>
                    <div class="result" id="analyzer-results">
                        <h4>Number Analysis</h4>
                        <div id="analyzer-results-content"></div>
                    </div>
                    
                    <div class="wheel-container">
                        <div class="wheel" id="number-wheel"></div>
                    </div>
                    
                    <div class="number-matrix" id="number-matrix"></div>
                </div>
            </div>
        </div>
        
        <!-- Draw History Tab -->
        <div id="history" class="tab-content">
            <div class="grid">
                <div>
                    <label for="history-game-type">Lottery Game:</label>
                    <select id="history-game-type">
                        <option value="powerball">Powerball (5/69 + 1/26)</option>
                        <option value="megamillions">Mega Millions (5/70 + 1/25)</option>
                        <option value="euromillions">EuroMillions (5/50 + 2/12)</option>
                        <option value="lotto649">Lotto 6/49</option>
                    </select>
                    
                    <label for="history-draw-count">Number of past draws to load:</label>
                    <input type="number" id="history-draw-count" min="1" max="100" value="10">
                    
                    <button onclick="loadHistory()" class="success">Load History</button>
                    <button onclick="clearHistory()" class="secondary">Clear</button>
                </div>
                
                <div>
                    <div class="history-table">
                        <table id="history-table">
                            <thead>
                                <tr>
                                    <th>Draw Date</th>
                                    <th>Numbers</th>
                                    <th>Bonus</th>
                                </tr>
                            </thead>
                            <tbody id="history-table-body">
                                <!-- History data will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="history-analysis">
                        <h4>Historical Analysis</h4>
                        <div id="history-analysis-content"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Strategies Tab -->
        <div id="strategies" class="tab-content">
            <div class="grid">
                <div>
                    <h3>Lottery Number Strategies</h3>
                    <p>Select a strategy to generate numbers based on different approaches:</p>
                    
                    <div class="strategy-selector">
                        <div class="strategy-option active" data-strategy="random">
                            <i class="fas fa-random"></i> Random
                        </div>
                        <div class="strategy-option" data-strategy="low-high">
                            <i class="fas fa-balance-scale"></i> Low-High
                        </div>
                        <div class="strategy-option" data-strategy="odd-even">
                            <i class="fas fa-divide"></i> Odd-Even
                        </div>
                        <div class="strategy-option" data-strategy="prime">
                            <i class="fas fa-superscript"></i> Prime
                        </div>
                        <div class="strategy-option" data-strategy="fibonacci">
                            <i class="fas fa-infinity"></i> Fibonacci
                        </div>
                        <div class="strategy-option" data-strategy="lucky">
                            <i class="fas fa-star"></i> Lucky
                        </div>
                        <div class="strategy-option" data-strategy="hot-cold">
                            <i class="fas fa-fire"></i> Hot/Cold
                        </div>
                        <div class="strategy-option" data-strategy="birthday">
                            <i class="fas fa-birthday-cake"></i> Birthday
                        </div>
                    </div>
                    
                    <div id="strategy-params">
                        <div id="random-params" class="strategy-param">
                            <p>Pure random number selection with no specific pattern.</p>
                        </div>
                        
                        <div id="low-high-params" class="strategy-param" style="display: none;">
                            <label for="low-high-ratio">Low to High Ratio:</label>
                            <select id="low-high-ratio">
                                <option value="balanced">Balanced (50/50)</option>
                                <option value="low-heavy">Low Heavy (70/30)</option>
                                <option value="high-heavy">High Heavy (30/70)</option>
                            </select>
                        </div>
                        
                        <div id="odd-even-params" class="strategy-param" style="display: none;">
                            <label for="odd-even-ratio">Odd to Even Ratio:</label>
                            <select id="odd-even-ratio">
                                <option value="balanced">Balanced (50/50)</option>
                                <option value="odd-heavy">Odd Heavy (70/30)</option>
                                <option value="even-heavy">Even Heavy (30/70)</option>
                            </select>
                        </div>
                        
                        <div id="prime-params" class="strategy-param" style="display: none;">
                            <label for="prime-count">Number of Primes:</label>
                            <select id="prime-count">
                                <option value="1">1 Prime</option>
                                <option value="2">2 Primes</option>
                                <option value="3">3 Primes</option>
                                <option value="4">4 Primes</option>
                                <option value="all">All Primes</option>
                            </select>
                        </div>
                        
                        <div id="fibonacci-params" class="strategy-param" style="display: none;">
                            <label for="fibonacci-count">Number of Fibonacci:</label>
                            <select id="fibonacci-count">
                                <option value="1">1 Fibonacci</option>
                                <option value="2">2 Fibonacci</option>
                                <option value="3">3 Fibonacci</option>
                                <option value="4">4 Fibonacci</option>
                                <option value="all">All Fibonacci</option>
                            </select>
                        </div>
                        
                        <div id="lucky-params" class="strategy-param" style="display: none;">
                            <label for="lucky-count">Number of Lucky:</label>
                            <select id="lucky-count">
                                <option value="1">1 Lucky</option>
                                <option value="2">2 Lucky</option>
                                <option value="3">3 Lucky</option>
                                <option value="4">4 Lucky</option>
                                <option value="all">All Lucky</option>
                            </select>
                        </div>
                        
                        <div id="hot-cold-params" class="strategy-param" style="display: none;">
                            <label for="hot-cold-ratio">Hot to Cold Ratio:</label>
                            <select id="hot-cold-ratio">
                                <option value="balanced">Balanced (50/50)</option>
                                <option value="hot-heavy">Hot Heavy (70/30)</option>
                                <option value="cold-heavy">Cold Heavy (30/70)</option>
                            </select>
                        </div>
                        
                        <div id="birthday-params" class="strategy-param" style="display: none;">
                            <label for="birthday-day">Day:</label>
                            <input type="number" id="birthday-day" min="1" max="31" placeholder="1-31">
                            
                            <label for="birthday-month">Month:</label>
                            <input type="number" id="birthday-month" min="1" max="12" placeholder="1-12">
                            
                            <label for="birthday-year">Year:</label>
                            <input type="number" id="birthday-year" min="1900" max="2100" placeholder="1900-2100">
                        </div>
                    </div>
                    
                    <button onclick="generateWithStrategy()" class="success">
                        <i class="fas fa-magic"></i> Generate with Strategy
                    </button>
                </div>
                
                <div>
                    <div class="result">
                        <h4>Strategy Explanation</h4>
                        <div id="strategy-explanation">
                            <p>The <strong>Random</strong> strategy generates numbers completely at random with no particular pattern or strategy. This mimics how lottery numbers are actually drawn.</p>
                        </div>
                    </div>
                    
                    <div id="strategy-results">
                        <h4>Generated Numbers</h4>
                        <div id="strategy-results-content"></div>
                    </div>
                    
                    <div id="strategy-statistics">
                        <h4>Strategy Statistics</h4>
                        <div id="strategy-statistics-content"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>Algorithm Documentation</h2>
            <div class="grid">
                <div>
                    <h3>Generation Algorithms</h3>
                    <div class="algorithm-info">
                        <h4>Standard Random</h4>
                        <p>Uses a basic pseudo-random number generator to select numbers. This is the simplest and most common approach.</p>
                    </div>
                    
                    <div class="algorithm-info">
                        <h4>Fisher-Yates Shuffle</h4>
                        <p>Creates a shuffled array of all possible numbers and selects the first N numbers. This ensures each number has an equal chance of being selected.</p>
                    </div>
                    
                    <div class="algorithm-info">
                        <h4>Cryptographically Secure</h4>
                        <p>Uses the browser's cryptographic functions to generate truly random numbers suitable for security-sensitive applications.</p>
                    </div>
                    
                    <div class="algorithm-info">
                        <h4>Low-High Balance</h4>
                        <p>Balances the selection between low and high numbers in the range to create a more distributed set of numbers.</p>
                    </div>
                </div>
                
                <div>
                    <h3>Number Strategies</h3>
                    <div class="algorithm-info">
                        <h4>Odd-Even Balance</h4>
                        <p>Balances the selection between odd and even numbers to create a more statistically likely combination.</p>
                    </div>
                    
                    <div class="algorithm-info">
                        <h4>Prime Numbers</h4>
                        <p>Focuses on selecting prime numbers which some players believe have special significance.</p>
                    </div>
                    
                    <div class="algorithm-info">
                        <h4>Fibonacci Numbers</h4>
                        <p>Selects numbers from the Fibonacci sequence which some players believe create harmonic combinations.</p>
                    </div>
                    
                    <div class="algorithm-info">
                        <h4>Hot & Cold Numbers</h4>
                        <p>Uses historical data to select a mix of frequently drawn (hot) and rarely drawn (cold) numbers.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="toast" class="toast"></div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Global variables
        let currentStrategy = 'random';
        let historyData = {};
        let hotColdData = {};
        let visualizationChart = null;

        // DOM Ready
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme
            initTheme();
            
            // Set up event listeners
            document.getElementById('lotto-game-type').addEventListener('change', updateLottoParams);
            document.getElementById('lotto-algorithm').addEventListener('change', updateAlgorithmParams);
            document.getElementById('analyzer-game-type').addEventListener('change', updateAnalyzer);
            document.getElementById('history-game-type').addEventListener('change', clearHistoryTable);
            
            // Strategy selectors
            document.querySelectorAll('.strategy-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.strategy-option').forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    currentStrategy = this.getAttribute('data-strategy');
                    updateStrategyParams();
                    updateStrategyExplanation();
                });
            });
            
            // Strategy parameter changes
            document.getElementById('low-high-ratio').addEventListener('change', updateStrategyExplanation);
            document.getElementById('odd-even-ratio').addEventListener('change', updateStrategyExplanation);
            document.getElementById('prime-count').addEventListener('change', updateStrategyExplanation);
            document.getElementById('fibonacci-count').addEventListener('change', updateStrategyExplanation);
            document.getElementById('lucky-count').addEventListener('change', updateStrategyExplanation);
            document.getElementById('hot-cold-ratio').addEventListener('change', updateStrategyExplanation);
            
            // Initialize displays
            updateLottoParams();
            updateAlgorithmParams();
            updateAnalyzer();
            updateStrategyExplanation();
            
            // Load sample hot/cold data
            loadSampleHotColdData();
            
            // Set up tab switching
            setupTabs();
        });

        // Tab functionality
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs and contents
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // Theme functionality
        function initTheme() {
            const themeToggle = document.getElementById('themeToggle');
            const currentTheme = localStorage.getItem('theme') || 'light';
            
            document.documentElement.setAttribute('data-theme', currentTheme);
            
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
            });
        }
        
        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show`;
            toast.style.backgroundColor = `var(--${type})`;
            
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }
        
        // Lotto Generator Functions
        function updateLottoParams() {
            const gameType = document.getElementById('lotto-game-type').value;
            const customParams = document.getElementById('lotto-custom-params');
            
            if (gameType === 'custom') {
                customParams.style.display = 'block';
            } else {
                customParams.style.display = 'none';
                
                // Set default values for known games
                switch(gameType) {
                    case 'powerball':
                        document.getElementById('lotto-main-numbers').value = 69;
                        document.getElementById('lotto-pick-numbers').value = 5;
                        document.getElementById('lotto-bonus-numbers').value = 26;
                        document.getElementById('lotto-pick-bonus').value = 1;
                        break;
                    case 'megamillions':
                        document.getElementById('lotto-main-numbers').value = 70;
                        document.getElementById('lotto-pick-numbers').value = 5;
                        document.getElementById('lotto-bonus-numbers').value = 25;
                        document.getElementById('lotto-pick-bonus').value = 1;
                        break;
                    case 'euromillions':
                        document.getElementById('lotto-main-numbers').value = 50;
                        document.getElementById('lotto-pick-numbers').value = 5;
                        document.getElementById('lotto-bonus-numbers').value = 12;
                        document.getElementById('lotto-pick-bonus').value = 2;
                        break;
                    case 'lotto649':
                        document.getElementById('lotto-main-numbers').value = 49;
                        document.getElementById('lotto-pick-numbers').value = 6;
                        document.getElementById('lotto-bonus-numbers').value = 0;
                        document.getElementById('lotto-pick-bonus').value = 0;
                        break;
                }
            }
        }
        
        function updateAlgorithmParams() {
            const algorithm = document.getElementById('lotto-algorithm').value;
            const strategyParams = document.getElementById('lotto-strategy-params');
            
            if (algorithm === 'hot-cold') {
                strategyParams.style.display = 'block';
            } else {
                strategyParams.style.display = 'none';
            }
            
            if (algorithm === 'multiple') {
                document.getElementById('multiple-param').style.display = 'block';
            } else {
                document.getElementById('multiple-param').style.display = 'none';
            }
        }

        function generateLottoNumbers() {
            const gameType = document.getElementById('lotto-game-type').value;
            let mainPool, pickCount, bonusPool, bonusCount;
            
            if (gameType === 'custom') {
                mainPool = parseInt(document.getElementById('lotto-main-numbers').value) || 69;
                pickCount = parseInt(document.getElementById('lotto-pick-numbers').value) || 5;
                bonusPool = parseInt(document.getElementById('lotto-bonus-numbers').value) || 26;
                bonusCount = parseInt(document.getElementById('lotto-pick-bonus').value) || 1;
            } else {
                switch(gameType) {
                    case 'powerball':
                        mainPool = 69;
                        pickCount = 5;
                        bonusPool = 26;
                        bonusCount = 1;
                        break;
                    case 'megamillions':
                        mainPool = 70;
                        pickCount = 5;
                        bonusPool = 25;
                        bonusCount = 1;
                        break;
                    case 'euromillions':
                        mainPool = 50;
                        pickCount = 5;
                        bonusPool = 12;
                        bonusCount = 2;
                        break;
                    case 'lotto649':
                        mainPool = 49;
                        pickCount = 6;
                        bonusPool = 0;
                        bonusCount = 0;
                        break;
                    default:
                        mainPool = 69;
                        pickCount = 5;
                        bonusPool = 26;
                        bonusCount = 1;
                }
            }
            
            const drawCount = parseInt(document.getElementById('lotto-draw-count').value) || 5;
            const seed = document.getElementById('lotto-seed').value || Math.floor(Math.random() * 1000000);
            const algorithm = document.getElementById('lotto-algorithm').value;
            const strategy = document.getElementById('lotto-strategy').value;
            const multipleValue = parseInt(document.getElementById('multiple-value').value) || 3;
            
            // Generate numbers
            const results = [];
            
            try {
                for (let i = 0; i < drawCount; i++) {
                    let mainNumbers, bonusNumbers;
                    
                    // Generate main numbers based on algorithm
                    switch(algorithm) {
                        case 'standard':
                            mainNumbers = generateStandardNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'shuffle':
                            mainNumbers = generateShuffledNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'crypto':
                            mainNumbers = generateCryptoNumbers(mainPool, pickCount);
                            break;
                        case 'low-high':
                            mainNumbers = generateLowHighNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'odd-even':
                            mainNumbers = generateOddEvenNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'prime':
                            mainNumbers = generatePrimeNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'fibonacci':
                            mainNumbers = generateFibonacciNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'lucky':
                            mainNumbers = generateLuckyNumbers(mainPool, pickCount, seed + i);
                            break;
                        case 'hot-cold':
                            mainNumbers = generateHotColdNumbers(mainPool, pickCount, seed + i, strategy);
                            break;
                        case 'multiple':
                            mainNumbers = generateMultipleNumbers(mainPool, pickCount, seed + i, multipleValue);
                            break;
                        default:
                            mainNumbers = generateStandardNumbers(mainPool, pickCount, seed + i);
                    }
                    
                    // Generate bonus numbers (always standard random)
                    if (bonusCount > 0) {
                        bonusNumbers = generateStandardNumbers(bonusPool, bonusCount, seed + i + 1000);
                    } else {
                        bonusNumbers = [];
                    }
                    
                    results.push({
                        main: mainNumbers,
                        bonus: bonusNumbers
                    });
                }
                
                // Display results
                displayLottoResults(results, gameType);
                
                // Update generation details
                document.getElementById('lotto-gen-details').innerHTML = `
                    <p><strong>Game Type:</strong> ${gameType}</p>
                    <p><strong>Main Numbers:</strong> Pick ${pickCount} from ${mainPool}</p>
                    ${bonusCount > 0 ? `<p><strong>Bonus Numbers:</strong> Pick ${bonusCount} from ${bonusPool}</p>` : ''}
                    <p><strong>Algorithm:</strong> ${algorithm}</p>
                    ${algorithm === 'hot-cold' ? `<p><strong>Strategy:</strong> ${strategy}</p>` : ''}
                    <p><strong>Seed:</strong> ${seed}</p>
                `;
                
                // Perform frequency analysis
                performFrequencyAnalysis(results, mainPool, bonusPool);
                
                showToast('Lotto numbers generated successfully', 'success');
            } catch (error) {
                showToast('Error generating numbers: ' + error.message, 'danger');
            }
        }

        // Number generation algorithms
        function generateStandardNumbers(poolSize, count, seed) {
            const generator = mulberry32(parseInt(seed));
            return generateUniqueNumbers(generator, poolSize, count);
        }
        
        function generateShuffledNumbers(poolSize, count, seed) {
            // Create array of all possible numbers
            const allNumbers = Array.from({length: poolSize}, (_, i) => i + 1);
            
            // Fisher-Yates shuffle algorithm
            const generator = mulberry32(parseInt(seed));
            for (let i = allNumbers.length - 1; i > 0; i--) {
                const j = Math.floor(generator() * (i + 1));
                [allNumbers[i], allNumbers[j]] = [allNumbers[j], allNumbers[i]];
            }
            
            // Return first 'count' numbers
            return allNumbers.slice(0, count).sort((a, b) => a - b);
        }
        
        async function generateCryptoNumbers(poolSize, count) {
            const numbers = [];
            const used = new Set();
            
            while (numbers.length < count) {
                const randomValues = new Uint32Array(1);
                crypto.getRandomValues(randomValues);
                const num = (randomValues[0] % poolSize) + 1;
                
                if (!used.has(num)) {
                    used.add(num);
                    numbers.push(num);
                }
            }
            
            return numbers.sort((a, b) => a - b);
        }
        
        function generateLowHighNumbers(poolSize, count, seed) {
            const generator = mulberry32(parseInt(seed));
            const midPoint = Math.floor(poolSize / 2);
            const lowPool = Array.from({length: midPoint}, (_, i) => i + 1);
            const highPool = Array.from({length: poolSize - midPoint}, (_, i) => midPoint + i + 1);
            
            // Determine how many low and high numbers to pick (balanced)
            const lowCount = Math.ceil(count / 2);
            const highCount = count - lowCount;
            
            // Shuffle pools
            shuffleArray(lowPool, generator());
            shuffleArray(highPool, generator());
            
            // Select numbers
            const result = [
                ...lowPool.slice(0, lowCount),
                ...highPool.slice(0, highCount)
            ];
            
            return result.sort((a, b) => a - b);
        }
        
        function generateOddEvenNumbers(poolSize, count, seed) {
            const generator = mulberry32(parseInt(seed));
            const oddNumbers = [];
            const evenNumbers = [];
            
            // Split into odd and even
            for (let i = 1; i <= poolSize; i++) {
                if (i % 2 === 0) {
                    evenNumbers.push(i);
                } else {
                    oddNumbers.push(i);
                }
            }
            
            // Determine how many odd and even numbers to pick (balanced)
            const oddCount = Math.ceil(count / 2);
            const evenCount = count - oddCount;
            
            // Shuffle pools
            shuffleArray(oddNumbers, generator());
            shuffleArray(evenNumbers, generator());
            
            // Select numbers
            const result = [
                ...oddNumbers.slice(0, oddCount),
                ...evenNumbers.slice(0, evenCount)
            ];
            
            return result.sort((a, b) => a - b);
        }
        
        function generatePrimeNumbers(poolSize, count, seed) {
            const generator = mulberry32(parseInt(seed));
            const primes = getPrimesUpTo(poolSize);
            
            if (primes.length < count) {
                // Not enough primes, fill with random numbers
                const nonPrimes = Array.from({length: poolSize}, (_, i) => i + 1)
                    .filter(n => !primes.includes(n));
                
                shuffleArray(primes, generator());
                shuffleArray(nonPrimes, generator());
                
                const result = [
                    ...primes,
                    ...nonPrimes.slice(0, count - primes.length)
                ];
                
                return result.slice(0, count).sort((a, b) => a - b);
            } else {
                shuffleArray(primes, generator());
                return primes.slice(0, count).sort((a, b) => a - b);
            }
        }
        
        function generateFibonacciNumbers(poolSize, count, seed) {
            const generator = mulberry32(parseInt(seed));
            const fibs = getFibonacciUpTo(poolSize);
            
            if (fibs.length < count) {
                // Not enough Fibonacci numbers, fill with random
                const nonFibs = Array.from({length: poolSize}, (_, i) => i + 1)
                    .filter(n => !fibs.includes(n));
                
                shuffleArray(fibs, generator());
                shuffleArray(nonFibs, generator());
                
                const result = [
                    ...fibs,
                    ...nonFibs.slice(0, count - fibs.length)
                ];
                
                return result.slice(0, count).sort((a, b) => a - b);
            } else {
                shuffleArray(fibs, generator());
                return fibs.slice(0, count).sort((a, b) => a - b);
            }
        }
        
        function generateLuckyNumbers(poolSize, count, seed) {
            const generator = mulberry32(parseInt(seed));
            const luckyNumbers = getLuckyNumbers(poolSize);
            
            if (luckyNumbers.length < count) {
                // Not enough lucky numbers, fill with random
                const nonLucky = Array.from({length: poolSize}, (_, i) => i + 1)
                    .filter(n => !luckyNumbers.includes(n));
                
                shuffleArray(luckyNumbers, generator());
                shuffleArray(nonLucky, generator());
                
                const result = [
                    ...luckyNumbers,
                    ...nonLucky.slice(0, count - luckyNumbers.length)
                ];
                
                return result.slice(0, count).sort((a, b) => a - b);
            } else {
                shuffleArray(luckyNumbers, generator());
                return luckyNumbers.slice(0, count).sort((a, b) => a - b);
            }
        }
        
        function generateHotColdNumbers(poolSize, count, seed, strategy) {
            const generator = mulberry32(parseInt(seed));
            
            // Get hot and cold numbers for this game type
            const gameType = document.getElementById('lotto-game-type').value;
            const hotNumbers = hotColdData[gameType]?.hot || [];
            const coldNumbers = hotColdData[gameType]?.cold || [];
            
            // Filter to only include numbers in the current pool
            const filteredHot = hotNumbers.filter(n => n <= poolSize);
            const filteredCold = coldNumbers.filter(n => n <= poolSize);
            
            // Determine how many hot and cold numbers to pick based on strategy
            let hotCount, coldCount;
            
            switch(strategy) {
                case 'random':
                    // Pure random selection ignoring hot/cold
                    return generateStandardNumbers(poolSize, count, seed);
                case 'spread':
                    // Balanced mix of hot and cold
                    hotCount = Math.ceil(count / 2);
                    coldCount = count - hotCount;
                    break;
                case 'cluster':
                    // Mostly hot numbers with some cold
                    hotCount = Math.ceil(count * 0.7);
                    coldCount = count - hotCount;
                    break;
                case 'sequential':
                    // Mostly cold numbers with some hot
                    hotCount = Math.ceil(count * 0.3);
                    coldCount = count - hotCount;
                    break;
                default:
                    hotCount = Math.ceil(count / 2);
                    coldCount = count - hotCount;
            }
            
            // If we don't have enough hot or cold numbers, adjust the counts
            if (filteredHot.length < hotCount) {
                coldCount += (hotCount - filteredHot.length);
                hotCount = filteredHot.length;
            }
            
            if (filteredCold.length < coldCount) {
                hotCount += (coldCount - filteredCold.length);
                coldCount = filteredCold.length;
            }
            
            // Shuffle the hot and cold numbers
            shuffleArray(filteredHot, generator());
            shuffleArray(filteredCold, generator());
            
            // Select the numbers
            const result = [
                ...filteredHot.slice(0, hotCount),
                ...filteredCold.slice(0, coldCount)
            ];
            
            // If we still don't have enough numbers, fill with random
            if (result.length < count) {
                const remainingNumbers = Array.from({length: poolSize}, (_, i) => i + 1)
                    .filter(n => !result.includes(n));
                
                shuffleArray(remainingNumbers, generator());
                result.push(...remainingNumbers.slice(0, count - result.length));
            }
            
            return result.sort((a, b) => a - b);
        }
        
        function generateMultipleNumbers(poolSize, count, seed, multiple) {
            const generator = mulberry32(parseInt(seed));
            const multiples = [];
            const nonMultiples = [];
            
            // Split into multiples and non-multiples
            for (let i = 1; i <= poolSize; i++) {
                if (i % multiple === 0) {
                    multiples.push(i);
                } else {
                    nonMultiples.push(i);
                }
            }
            
            // Determine how many multiples to include (at least 1)
            const multiplesCount = Math.max(1, Math.floor(count * 0.3));
            const nonMultiplesCount = count - multiplesCount;
            
            // Shuffle both arrays
            shuffleArray(multiples, generator());
            shuffleArray(nonMultiples, generator());
            
            // Select numbers
            const result = [
                ...multiples.slice(0, multiplesCount),
                ...nonMultiples.slice(0, nonMultiplesCount)
            ];
            
            return result.sort((a, b) => a - b);
        }
        
        // Helper functions for number generation
        function generateUniqueNumbers(generator, poolSize, count) {
            const numbers = [];
            while (numbers.length < count) {
                const num = Math.floor(generator() * poolSize) + 1;
                if (!numbers.includes(num)) {
                    numbers.push(num);
                }
            }
            return numbers.sort((a, b) => a - b);
        }
        
        function shuffleArray(array, seed) {
            const generator = mulberry32(seed);
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(generator() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        
        function getPrimesUpTo(max) {
            const sieve = new Array(max + 1).fill(true);
            sieve[0] = sieve[1] = false;
            
            for (let i = 2; i <= Math.sqrt(max); i++) {
                if (sieve[i]) {
                    for (let j = i * i; j <= max; j += i) {
                        sieve[j] = false;
                    }
                }
            }
            
            return sieve.map((isPrime, num) => isPrime ? num : 0).filter(num => num > 0);
        }
        
        function getFibonacciUpTo(max) {
            const fibs = [1, 2];
            let next = 3;
            
            while (next <= max) {
                fibs.push(next);
                next = fibs[fibs.length - 1] + fibs[fibs.length - 2];
            }
            
            return fibs;
        }
        
        function getLuckyNumbers(max) {
            // Lucky numbers sieve algorithm
            const numbers = Array.from({length: max}, (_, i) => i + 1);
            let index = 1;
            let step = 2;
            
            while (step <= numbers.length) {
                const newNumbers = [];
                for (let i = 0; i < numbers.length; i++) {
                    if ((i + 1) % step !== 0) {
                        newNumbers.push(numbers[i]);
                    }
                }
                numbers.length = 0;
                numbers.push(...newNumbers);
                index++;
                step = numbers[index];
            }
            
            return numbers;
        }
        
        // Mulberry32 PRNG
        function mulberry32(seed) {
            return function() {
                seed += 0x6D2B79F5;
                let t = Math.imul(seed ^ seed >>> 15, 1 | seed);
                t = t + Math.imul(t ^ t >>> 7, 61 | t) ^ t;
                return ((t ^ t >>> 14) >>> 0) / 4294967296;
            };
        }

        function displayLottoResults(results, gameType) {
            const container = document.getElementById('lotto-generated-results');
            container.innerHTML = '';
            
            results.forEach((draw, index) => {
                const drawElement = document.createElement('div');
                drawElement.className = 'lotto-draw';
                drawElement.style.marginBottom = '15px';
                
                const drawTitle = document.createElement('h4');
                drawTitle.textContent = `Draw ${index + 1}:`;
                drawElement.appendChild(drawTitle);
                
                const ballsContainer = document.createElement('div');
                ballsContainer.className = 'lotto-balls';
                
                // Main numbers
                draw.main.forEach(num => {
                    const ball = document.createElement('div');
                    ball.className = 'ball';
                    ball.textContent = num;
                    ballsContainer.appendChild(ball);
                });
                
                // Bonus numbers
                if (draw.bonus.length > 0) {
                    const separator = document.createElement('span');
                    separator.textContent = ' + ';
                    separator.style.margin = '0 5px';
                    ballsContainer.appendChild(separator);
                    
                    draw.bonus.forEach(num => {
                        const ball = document.createElement('div');
                        ball.className = 'ball ' + 
                            (gameType === 'powerball' ? 'powerball' : 
                             gameType === 'megamillions' ? 'megaball' : 
                             gameType === 'euromillions' ? 'eurostar' : 'ball');
                        ball.textContent = num;
                        ballsContainer.appendChild(ball);
                    });
                }
                
                drawElement.appendChild(ballsContainer);
                container.appendChild(drawElement);
            });
        }

        function performFrequencyAnalysis(results, mainPool, bonusPool) {
            // Count frequency of main numbers
            const mainFreq = {};
            for (let i = 1; i <= mainPool; i++) {
                mainFreq[i] = 0;
            }
            
            // Count frequency of bonus numbers
            const bonusFreq = {};
            if (bonusPool > 0) {
                for (let i = 1; i <= bonusPool; i++) {
                    bonusFreq[i] = 0;
                }
            }
            
            // Count occurrences
            results.forEach(draw => {
                draw.main.forEach(num => {
                    mainFreq[num]++;
                });
                
                draw.bonus.forEach(num => {
                    bonusFreq[num]++;
                });
            });
            
            // Display frequency analysis
            let frequencyHTML = '<h4>Main Numbers Frequency</h4>';
            frequencyHTML += '<div class="histogram">';
            
            // Create histogram for main numbers
            const mainNumbers = Object.keys(mainFreq);
            const maxMainFreq = Math.max(...Object.values(mainFreq));
            
            mainNumbers.forEach(num => {
                const freq = mainFreq[num];
                const height = maxMainFreq > 0 ? (freq / maxMainFreq * 100) : 0;
                
                frequencyHTML += `
                    <div class="histogram-bar" style="height: ${height}%">
                        <div class="histogram-bar-label">${num}</div>
                    </div>
                `;
            });
            
            frequencyHTML += '</div>';
            
            // Add bonus numbers frequency if applicable
            if (bonusPool > 0) {
                frequencyHTML += '<h4>Bonus Numbers Frequency</h4>';
                frequencyHTML += '<div class="histogram">';
                
                const bonusNumbers = Object.keys(bonusFreq);
                const maxBonusFreq = Math.max(...Object.values(bonusFreq));
                
                bonusNumbers.forEach(num => {
                    const freq = bonusFreq[num];
                    const height = maxBonusFreq > 0 ? (freq / maxBonusFreq * 100) : 0;
                    
                    frequencyHTML += `
                        <div class="histogram-bar" style="height: ${height}%">
                            <div class="histogram-bar-label">${num}</div>
                        </div>
                    `;
                });
                
                frequencyHTML += '</div>';
            }
            
            document.getElementById('lotto-frequency-content').innerHTML = frequencyHTML;
        }

        function clearLottoGeneration() {
            document.getElementById('lotto-generated-results').innerHTML = '';
            document.getElementById('lotto-gen-details').innerHTML = '';
            document.getElementById('lotto-frequency-content').innerHTML = '';
            document.getElementById('lotto-seed').value = '';
        }

        function randomizeLottoSeed() {
            document.getElementById('lotto-seed').value = Math.floor(Math.random() * 1000000);
            showToast('Random seed generated', 'info');
        }
        
        function quickPick() {
            // Set random seed and generate immediately
            randomizeLottoSeed();
            generateLottoNumbers();
        }

        function exportLottoNumbers(format) {
            const results = document.getElementById('lotto-generated-results').innerText;
            if (!results.trim()) {
                showToast('No numbers to export', 'warning');
                return;
            }
            
            if (format === 'csv') {
                exportToCSV(results, 'lotto_numbers.csv');
            } else if (format === 'json') {
                exportToJSON(results, 'lotto_numbers.json');
            } else {
                exportToFile(results, 'lotto_numbers.txt');
            }
        }

        function copyLottoNumbers() {
            const results = document.getElementById('lotto-generated-results').innerText;
            if (!results.trim()) {
                showToast('No numbers to copy', 'warning');
                return;
            }
            
            navigator.clipboard.writeText(results).then(() => {
                showToast('Lotto numbers copied to clipboard', 'success');
            }).catch(err => {
                showToast('Failed to copy: ' + err, 'danger');
            });
        }
        
        // Number Analyzer Functions
        function updateAnalyzer() {
            const gameType = document.getElementById('analyzer-game-type').value;
            const matrix = document.getElementById('number-matrix');
            matrix.innerHTML = '';
            
            let poolSize = 69; // Default to Powerball
            
            switch(gameType) {
                case 'powerball':
                    poolSize = 69;
                    break;
                case 'megamillions':
                    poolSize = 70;
                    break;
                case 'euromillions':
                    poolSize = 50;
                    break;
                case 'lotto649':
                    poolSize = 49;
                    break;
            }
            
            // Create number matrix
            for (let i = 1; i <= poolSize; i++) {
                const cell = document.createElement('div');
                cell.className = 'number-cell';
                cell.textContent = i;
                cell.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    updateNumberInput();
                });
                matrix.appendChild(cell);
            }
        }
        
        function updateNumberInput() {
            const selected = document.querySelectorAll('.number-cell.selected');
            const numbers = Array.from(selected).map(cell => cell.textContent).join(', ');
            document.getElementById('analyzer-numbers').value = numbers;
        }
        
        function analyzeNumbers() {
            const numbersText = document.getElementById('analyzer-numbers').value.trim();
            if (!numbersText) {
                showToast('Please enter numbers to analyze', 'warning');
                return;
            }
            
            const numbers = numbersText.split(',').map(num => parseInt(num.trim())).filter(num => !isNaN(num));
            if (numbers.length === 0) {
                showToast('No valid numbers entered', 'warning');
                return;
            }
            
            const gameType = document.getElementById('analyzer-game-type').value;
            let mainPool, pickCount;
            
            switch(gameType) {
                case 'powerball':
                    mainPool = 69;
                    pickCount = 5;
                    break;
                case 'megamillions':
                    mainPool = 70;
                    pickCount = 5;
                    break;
                case 'euromillions':
                    mainPool = 50;
                    pickCount = 5;
                    break;
                case 'lotto649':
                    mainPool = 49;
                    pickCount = 6;
                    break;
                default:
                    mainPool = 69;
                    pickCount = 5;
            }
            
            // Validate number count
            if (numbers.length !== pickCount) {
                showToast(`This game requires exactly ${pickCount} numbers`, 'warning');
                return;
            }
            
            // Validate number range
            const outOfRange = numbers.filter(n => n < 1 || n > mainPool);
            if (outOfRange.length > 0) {
                showToast(`Numbers must be between 1 and ${mainPool}`, 'warning');
                return;
            }
            
            // Check for duplicates
            const uniqueNumbers = [...new Set(numbers)];
            if (uniqueNumbers.length !== numbers.length) {
                showToast('Duplicate numbers detected', 'warning');
                return;
            }
            
            // Sort the numbers
            const sortedNumbers = [...numbers].sort((a, b) => a - b);
            
            // Perform analysis
            const sum = numbers.reduce((a, b) => a + b, 0);
            const average = sum / numbers.length;
            const range = Math.max(...numbers) - Math.min(...numbers);
            
            // Count odd/even
            const oddCount = numbers.filter(n => n % 2 !== 0).length;
            const evenCount = numbers.length - oddCount;
            
            // Check for primes
            const primes = getPrimesUpTo(mainPool);
            const primeCount = numbers.filter(n => primes.includes(n)).length;
            
            // Check for Fibonacci numbers
            const fibs = getFibonacciUpTo(mainPool);
            const fibCount = numbers.filter(n => fibs.includes(n)).length;
            
            // Check for lucky numbers
            const luckyNumbers = getLuckyNumbers(mainPool);
            const luckyCount = numbers.filter(n => luckyNumbers.includes(n)).length;
            
            // Calculate low/high distribution (low = bottom half)
            const midPoint = Math.floor(mainPool / 2);
            const lowCount = numbers.filter(n => n <= midPoint).length;
            const highCount = numbers.length - lowCount;
            
            // Calculate consecutive numbers
            let consecutiveCount = 0;
            for (let i = 1; i < sortedNumbers.length; i++) {
                if (sortedNumbers[i] === sortedNumbers[i-1] + 1) {
                    consecutiveCount++;
                }
            }
            
            // Calculate number spacing
            const spacings = [];
            for (let i = 1; i < sortedNumbers.length; i++) {
                spacings.push(sortedNumbers[i] - sortedNumbers[i-1]);
            }
            const avgSpacing = spacings.reduce((a, b) => a + b, 0) / spacings.length;
            
            // Display results
            let resultsHTML = `
                <p><strong>Numbers:</strong> ${sortedNumbers.join(', ')}</p>
                <p><strong>Sum:</strong> ${sum} (Average: ${average.toFixed(1)})</p>
                <p><strong>Range:</strong> ${range} (Min: ${Math.min(...numbers)}, Max: ${Math.max(...numbers)})</p>
                <p><strong>Odd/Even:</strong> ${oddCount} odd / ${evenCount} even</p>
                <p><strong>Low/High:</strong> ${lowCount} low / ${highCount} high</p>
                <p><strong>Special Numbers:</strong> ${primeCount} primes, ${fibCount} Fibonacci, ${luckyCount} lucky</p>
                <p><strong>Consecutive Pairs:</strong> ${consecutiveCount}</p>
                <p><strong>Average Spacing:</strong> ${avgSpacing.toFixed(1)}</p>
            `;
            
            // Add hot/cold analysis if available
            const gameHotCold = hotColdData[gameType];
            if (gameHotCold) {
                const hotNumbers = numbers.filter(n => gameHotCold.hot.includes(n)).length;
                const coldNumbers = numbers.filter(n => gameHotCold.cold.includes(n)).length;
                resultsHTML += `<p><strong>Hot/Cold:</strong> ${hotNumbers} hot / ${coldNumbers} cold</p>`;
            }
            
            document.getElementById('analyzer-results-content').innerHTML = resultsHTML;
            
            // Update wheel visualization
            updateNumberWheel(numbers, mainPool);
            
            // Highlight selected numbers in matrix
            document.querySelectorAll('.number-cell').forEach(cell => {
                cell.classList.remove('selected');
            });
            
            numbers.forEach(num => {
                const cell = document.querySelector(`.number-cell:nth-child(${num})`);
                if (cell) {
                    cell.classList.add('selected');
                }
            });
            
            showToast('Numbers analyzed successfully', 'success');
        }
        
        function updateNumberWheel(numbers, poolSize) {
            const wheel = document.getElementById('number-wheel');
            wheel.innerHTML = '';
            
            const centerX = 150;
            const centerY = 150;
            const radius = 120;
            
            numbers.forEach((num, index) => {
                const angle = (num / poolSize) * 2 * Math.PI;
                const x = centerX + radius * Math.sin(angle);
                const y = centerY - radius * Math.cos(angle);
                
                const numberElement = document.createElement('div');
                numberElement.className = 'wheel-number';
                numberElement.textContent = num;
                numberElement.style.left = `${x}px`;
                numberElement.style.top = `${y}px`;
                numberElement.style.transform = `rotate(${angle}rad)`;
                numberElement.style.backgroundColor = `hsl(${(num / poolSize) * 360}, 70%, 60%)`;
                
                wheel.appendChild(numberElement);
            });
        }
        
        function clearAnalyzer() {
            document.getElementById('analyzer-numbers').value = '';
            document.getElementById('analyzer-results-content').innerHTML = '';
            document.getElementById('number-wheel').innerHTML = '';
            
            document.querySelectorAll('.number-cell').forEach(cell => {
                cell.classList.remove('selected');
            });
        }
        
        // History Functions
        function loadHistory() {
            const gameType = document.getElementById('history-game-type').value;
            const drawCount = parseInt(document.getElementById('history-draw-count').value) || 10;
            
            // In a real app, this would fetch from an API
            // For demo purposes, we'll generate some random history
            const history = generateRandomHistory(gameType, drawCount);
            historyData[gameType] = history;
            
            // Display in table
            const tableBody = document.getElementById('history-table-body');
            tableBody.innerHTML = '';
            
            history.forEach(draw => {
                const row = document.createElement('tr');
                
                const dateCell = document.createElement('td');
                dateCell.textContent = draw.date;
                row.appendChild(dateCell);
                
                const numbersCell = document.createElement('td');
                numbersCell.textContent = draw.numbers.join(', ');
                row.appendChild(numbersCell);
                
                const bonusCell = document.createElement('td');
                bonusCell.textContent = draw.bonus?.join(', ') || 'N/A';
                row.appendChild(bonusCell);
                
                tableBody.appendChild(row);
            });
            
            // Perform historical analysis
            performHistoricalAnalysis(gameType);
            
            showToast(`Loaded ${drawCount} historical draws for ${gameType}`, 'success');
        }
        
        function generateRandomHistory(gameType, count) {
            const history = [];
            let mainPool, pickCount, bonusPool, bonusCount;
            
            switch(gameType) {
                case 'powerball':
                    mainPool = 69;
                    pickCount = 5;
                    bonusPool = 26;
                    bonusCount = 1;
                    break;
                case 'megamillions':
                    mainPool = 70;
                    pickCount = 5;
                    bonusPool = 25;
                    bonusCount = 1;
                    break;
                case 'euromillions':
                    mainPool = 50;
                    pickCount = 5;
                    bonusPool = 12;
                    bonusCount = 2;
                    break;
                case 'lotto649':
                    mainPool = 49;
                    pickCount = 6;
                    bonusPool = 0;
                    bonusCount = 0;
                    break;
                default:
                    mainPool = 69;
                    pickCount = 5;
                    bonusPool = 26;
                    bonusCount = 1;
            }
            
            // Generate dates (past 3 months)
            const now = new Date();
            const startDate = new Date(now);
            startDate.setMonth(now.getMonth() - 3);
            
            for (let i = 0; i < count; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + Math.floor(i * (90 / count)));
                
                const draw = {
                    date: date.toLocaleDateString(),
                    numbers: generateStandardNumbers(mainPool, pickCount, i),
                    bonus: bonusCount > 0 ? generateStandardNumbers(bonusPool, bonusCount, i + 1000) : []
                };
                
                history.push(draw);
            }
            
            return history;
        }
        
        function performHistoricalAnalysis(gameType) {
            const history = historyData[gameType] || [];
            if (history.length === 0) return;
            
            let mainPool;
            switch(gameType) {
                case 'powerball': mainPool = 69; break;
                case 'megamillions': mainPool = 70; break;
                case 'euromillions': mainPool = 50; break;
                case 'lotto649': mainPool = 49; break;
                default: mainPool = 69;
            }
            
            // Count frequency of each number
            const frequency = {};
            for (let i = 1; i <= mainPool; i++) {
                frequency[i] = 0;
            }
            
            history.forEach(draw => {
                draw.numbers.forEach(num => {
                    frequency[num]++;
                });
            });
            
            // Convert to array and sort by frequency
            const frequencyArray = Object.entries(frequency).map(([num, count]) => ({
                number: parseInt(num),
                count
            }));
            
            frequencyArray.sort((a, b) => b.count - a.count);
            
            // Get hot (most frequent) and cold (least frequent) numbers
            const hotNumbers = frequencyArray.slice(0, 10).map(item => item.number);
            const coldNumbers = frequencyArray.slice(-10).map(item => item.number);
            
            // Store for hot/cold strategy
            hotColdData[gameType] = {
                hot: hotNumbers,
                cold: coldNumbers
            };
            
            // Display analysis
            let analysisHTML = '<h4>Most Frequent Numbers (Hot)</h4>';
            analysisHTML += '<div class="lotto-balls">';
            
            hotNumbers.forEach(num => {
                analysisHTML += `<div class="ball hot-number">${num}</div>`;
            });
            
            analysisHTML += '</div><h4>Least Frequent Numbers (Cold)</h4>';
            analysisHTML += '<div class="lotto-balls">';
            
            coldNumbers.forEach(num => {
                analysisHTML += `<div class="ball cold-number">${num}</div>`;
            });
            
            analysisHTML += '</div>';
            
            document.getElementById('history-analysis-content').innerHTML = analysisHTML;
        }
        
        function clearHistoryTable() {
            document.getElementById('history-table-body').innerHTML = '';
            document.getElementById('history-analysis-content').innerHTML = '';
        }
        
        function clearHistory() {
            const gameType = document.getElementById('history-game-type').value;
            historyData[gameType] = [];
            clearHistoryTable();
        }
        
        // Strategy Functions
        function updateStrategyParams() {
            // Hide all parameter sections
            document.querySelectorAll('.strategy-param').forEach(el => {
                el.style.display = 'none';
            });
            
            // Show the active one
            document.getElementById(`${currentStrategy}-params`).style.display = 'block';
        }
        
        function updateStrategyExplanation() {
            let explanation = '';
            let params = '';
            
            switch(currentStrategy) {
                case 'random':
                    explanation = `
                        <p>The <strong>Random</strong> strategy generates numbers completely at random with no particular pattern or strategy. This mimics how lottery numbers are actually drawn.</p>
                        <p>This approach gives you the same odds as any other combination since each number has an equal chance of being drawn.</p>
                    `;
                    break;
                    
                case 'low-high':
                    const lowHighRatio = document.getElementById('low-high-ratio').value;
                    params = `Using ${lowHighRatio.replace('-', ' ')} distribution`;
                    
                    explanation = `
                        <p>The <strong>Low-High</strong> strategy balances your numbers between the lower and higher halves of the number range.</p>
                        <p>In most lottery games, winning numbers tend to be evenly distributed between low and high numbers. This strategy aims to match that distribution.</p>
                        <p><strong>Current settings:</strong> ${params}</p>
                    `;
                    break;
                    
                case 'odd-even':
                    const oddEvenRatio = document.getElementById('odd-even-ratio').value;
                    params = `Using ${oddEvenRatio.replace('-', ' ')} distribution`;
                    
                    explanation = `
                        <p>The <strong>Odd-Even</strong> strategy balances your numbers between odd and even numbers.</p>
                        <p>Historical data shows that most winning combinations have a mix of odd and even numbers, rarely all odd or all even.</p>
                        <p><strong>Current settings:</strong> ${params}</p>
                    `;
                    break;
                    
                case 'prime':
                    const primeCount = document.getElementById('prime-count').value;
                    params = `Including ${primeCount === 'all' ? 'only primes' : primeCount + ' primes'}`;
                    
                    explanation = `
                        <p>The <strong>Prime</strong> strategy focuses on including prime numbers in your selection.</p>
                        <p>Prime numbers (numbers divisible only by 1 and themselves) are favored by some players who believe they appear more frequently or have special significance.</p>
                        <p><strong>Current settings:</strong> ${params}</p>
                    `;
                    break;
                    
                case 'fibonacci':
                    const fibCount = document.getElementById('fibonacci-count').value;
                    params = `Including ${fibCount === 'all' ? 'only Fibonacci' : fibCount + ' Fibonacci'}`;
                    
                    explanation = `
                        <p>The <strong>Fibonacci</strong> strategy selects numbers from the Fibonacci sequence (1, 2, 3, 5, 8, 13, etc.).</p>
                        <p>Some players believe these numbers create harmonic combinations that are more likely to appear together.</p>
                        <p><strong>Current settings:</strong> ${params}</p>
                    `;
                    break;
                    
                case 'lucky':
                    const luckyCount = document.getElementById('lucky-count').value;
                    params = `Including ${luckyCount === 'all' ? 'only lucky numbers' : luckyCount + ' lucky numbers'}`;
                    
                    explanation = `
                        <p>The <strong>Lucky</strong> strategy uses numbers identified by the "sieve of Eratosthenes" algorithm for lucky numbers.</p>
                        <p>These numbers are considered lucky in number theory and are favored by some lottery players.</p>
                        <p><strong>Current settings:</strong> ${params}</p>
                    `;
                    break;
                    
                case 'hot-cold':
                    const hotColdRatio = document.getElementById('hot-cold-ratio').value;
                    params = `Using ${hotColdRatio.replace('-', ' ')} distribution`;
                    
                    explanation = `
                        <p>The <strong>Hot-Cold</strong> strategy mixes frequently drawn (hot) and rarely drawn (cold) numbers based on historical data.</p>
                        <p>Some players believe hot numbers are "on a streak" while cold numbers are "due" to appear.</p>
                        <p><strong>Current settings:</strong> ${params}</p>
                    `;
                    break;
                    
                case 'birthday':
                    explanation = `
                        <p>The <strong>Birthday</strong> strategy uses numbers derived from personal dates like birthdays, anniversaries, etc.</p>
                        <p>While these numbers have personal significance, they tend to cluster in the lower range (1-31) and may limit your coverage of the number pool.</p>
                    `;
                    break;
            }
            
            document.getElementById('strategy-explanation').innerHTML = explanation;
        }
        
        function generateWithStrategy() {
            const gameType = document.getElementById('lotto-game-type').value;
            let mainPool, pickCount;
            
            switch(gameType) {
                case 'powerball':
                    mainPool = 69;
                    pickCount = 5;
                    break;
                case 'megamillions':
                    mainPool = 70;
                    pickCount = 5;
                    break;
                case 'euromillions':
                    mainPool = 50;
                    pickCount = 5;
                    break;
                case 'lotto649':
                    mainPool = 49;
                    pickCount = 6;
                    break;
                default:
                    mainPool = 69;
                    pickCount = 5;
            }
            
            let numbers = [];
            const seed = Math.floor(Math.random() * 1000000);
            
            switch(currentStrategy) {
                case 'random':
                    numbers = generateStandardNumbers(mainPool, pickCount, seed);
                    break;
                    
                case 'low-high':
                    const lowHighRatio = document.getElementById('low-high-ratio').value;
                    let lowCount, highCount;
                    
                    if (lowHighRatio === 'balanced') {
                        lowCount = Math.ceil(pickCount / 2);
                    } else if (lowHighRatio === 'low-heavy') {
                        lowCount = Math.ceil(pickCount * 0.7);
                    } else { // high-heavy
                        lowCount = Math.floor(pickCount * 0.3);
                    }
                    
                    highCount = pickCount - lowCount;
                    
                    const lowNumbers = generateStandardNumbers(Math.floor(mainPool / 2), lowCount, seed);
                    const highNumbers = generateStandardNumbers(
                        mainPool - Math.floor(mainPool / 2), 
                        highCount, 
                        seed + 1
                    ).map(n => n + Math.floor(mainPool / 2));
                    
                    numbers = [...lowNumbers, ...highNumbers].sort((a, b) => a - b);
                    break;
                    
                case 'odd-even':
                    const oddEvenRatio = document.getElementById('odd-even-ratio').value;
                    let oddCount, evenCount;
                    
                    if (oddEvenRatio === 'balanced') {
                        oddCount = Math.ceil(pickCount / 2);
                    } else if (oddEvenRatio === 'odd-heavy') {
                        oddCount = Math.ceil(pickCount * 0.7);
                    } else { // even-heavy
                        oddCount = Math.floor(pickCount * 0.3);
                    }
                    
                    evenCount = pickCount - oddCount;
                    
                    // Generate odd numbers
                    const oddNumbers = [];
                    const oddGenerator = mulberry32(seed);
                    while (oddNumbers.length < oddCount) {
                        const num = Math.floor(oddGenerator() * mainPool) + 1;
                        if (num % 2 !== 0 && !oddNumbers.includes(num)) {
                            oddNumbers.push(num);
                        }
                    }
                    
                    // Generate even numbers
                    const evenNumbers = [];
                    const evenGenerator = mulberry32(seed + 1);
                    while (evenNumbers.length < evenCount) {
                        const num = Math.floor(evenGenerator() * mainPool) + 1;
                        if (num % 2 === 0 && !evenNumbers.includes(num)) {
                            evenNumbers.push(num);
                        }
                    }
                    
                    numbers = [...oddNumbers, ...evenNumbers].sort((a, b) => a - b);
                    break;
                    
                case 'prime':
                    const primeSelection = document.getElementById('prime-count').value;
                    const primes = getPrimesUpTo(mainPool);
                    
                    if (primeSelection === 'all' || primes.length < pickCount) {
                        // If not enough primes, fill with random
                        numbers = generatePrimeNumbers(mainPool, pickCount, seed);
                    } else {
                        const primeCount = parseInt(primeSelection);
                        const nonPrimes = Array.from({length: mainPool}, (_, i) => i + 1)
                            .filter(n => !primes.includes(n));
                        
                        // Shuffle primes and non-primes
                        shuffleArray(primes, seed);
                        shuffleArray(nonPrimes, seed + 1);
                        
                        numbers = [
                            ...primes.slice(0, primeCount),
                            ...nonPrimes.slice(0, pickCount - primeCount)
                        ].sort((a, b) => a - b);
                    }
                    break;
                    
                case 'fibonacci':
                    const fibSelection = document.getElementById('fibonacci-count').value;
                    const fibs = getFibonacciUpTo(mainPool);
                    
                    if (fibSelection === 'all' || fibs.length < pickCount) {
                        numbers = generateFibonacciNumbers(mainPool, pickCount, seed);
                    } else {
                        const fibCount = parseInt(fibSelection);
                        const nonFibs = Array.from({length: mainPool}, (_, i) => i + 1)
                            .filter(n => !fibs.includes(n));
                        
                        // Shuffle fibs and non-fibs
                        shuffleArray(fibs, seed);
                        shuffleArray(nonFibs, seed + 1);
                        
                        numbers = [
                            ...fibs.slice(0, fibCount),
                            ...nonFibs.slice(0, pickCount - fibCount)
                        ].sort((a, b) => a - b);
                    }
                    break;
                    
                case 'lucky':
                    const luckySelection = document.getElementById('lucky-count').value;
                    const luckyNumbers = getLuckyNumbers(mainPool);
                    
                    if (luckySelection === 'all' || luckyNumbers.length < pickCount) {
                        numbers = generateLuckyNumbers(mainPool, pickCount, seed);
                    } else {
                        const luckyCount = parseInt(luckySelection);
                        const nonLucky = Array.from({length: mainPool}, (_, i) => i + 1)
                            .filter(n => !luckyNumbers.includes(n));
                        
                        // Shuffle lucky and non-lucky
                        shuffleArray(luckyNumbers, seed);
                        shuffleArray(nonLucky, seed + 1);
                        
                        numbers = [
                            ...luckyNumbers.slice(0, luckyCount),
                            ...nonLucky.slice(0, pickCount - luckyCount)
                        ].sort((a, b) => a - b);
                    }
                    break;
                    
                case 'hot-cold':
                    const hotColdRatio = document.getElementById('hot-cold-ratio').value;
                    let hotCount, coldCount;
                    
                    if (hotColdRatio === 'balanced') {
                        hotCount = Math.ceil(pickCount / 2);
                    } else if (hotColdRatio === 'hot-heavy') {
                        hotCount = Math.ceil(pickCount * 0.7);
                    } else { // cold-heavy
                        hotCount = Math.floor(pickCount * 0.3);
                    }
                    
                    coldCount = pickCount - hotCount;
                    
                    // Get hot and cold numbers for this game
                    const gameHotCold = hotColdData[gameType] || { hot: [], cold: [] };
                    
                    // If we don't have hot/cold data, fall back to standard
                    if (gameHotCold.hot.length === 0 || gameHotCold.cold.length === 0) {
                        numbers = generateStandardNumbers(mainPool, pickCount, seed);
                    } else {
                        // Filter to ensure numbers are within pool
                        const hotNumbers = gameHotCold.hot.filter(n => n <= mainPool);
                        const coldNumbers = gameHotCold.cold.filter(n => n <= mainPool);
                        
                        // Adjust counts if we don't have enough
                        if (hotNumbers.length < hotCount) {
                            coldCount += (hotCount - hotNumbers.length);
                            hotCount = hotNumbers.length;
                        }
                        
                        if (coldNumbers.length < coldCount) {
                            hotCount += (coldCount - coldNumbers.length);
                            coldCount = coldNumbers.length;
                        }
                        
                        // Shuffle and select
                        shuffleArray(hotNumbers, seed);
                        shuffleArray(coldNumbers, seed + 1);
                        
                        numbers = [
                            ...hotNumbers.slice(0, hotCount),
                            ...coldNumbers.slice(0, coldCount)
                        ].sort((a, b) => a - b);
                        
                        // If we still don't have enough, fill with random
                        if (numbers.length < pickCount) {
                            const remaining = Array.from({length: mainPool}, (_, i) => i + 1)
                                .filter(n => !numbers.includes(n));
                            
                            shuffleArray(remaining, seed + 2);
                            numbers = [...numbers, ...remaining.slice(0, pickCount - numbers.length)]
                                .sort((a, b) => a - b);
                        }
                    }
                    break;
                    
                case 'birthday':
                    const day = parseInt(document.getElementById('birthday-day').value) || 1;
                    const month = parseInt(document.getElementById('birthday-month').value) || 1;
                    const year = parseInt(document.getElementById('birthday-year').value) || 2000;
                    
                    // Generate numbers from birthday
                    const lastTwoOfYear = year % 100;
                    const dayPlusMonth = day + month;
                    const monthTimesTwo = month * 2;
                    const yearMinusDay = Math.max(1, year - day);
                    
                    // Create candidate numbers
                    const candidates = [
                        day, 
                        month, 
                        lastTwoOfYear,
                        dayPlusMonth,
                        monthTimesTwo,
                        yearMinusDay % mainPool || mainPool
                    ].filter(n => n >= 1 && n <= mainPool);
                    
                    // Remove duplicates
                    const uniqueCandidates = [...new Set(candidates)];
                    
                    // If we have enough, use them
                    if (uniqueCandidates.length >= pickCount) {
                        shuffleArray(uniqueCandidates, seed);
                        numbers = uniqueCandidates.slice(0, pickCount).sort((a, b) => a - b);
                    } else {
                        // Fill with random numbers
                        numbers = [...uniqueCandidates];
                        const remaining = Array.from({length: mainPool}, (_, i) => i + 1)
                            .filter(n => !numbers.includes(n));
                        
                        shuffleArray(remaining, seed);
                        numbers = [...numbers, ...remaining.slice(0, pickCount - numbers.length)]
                            .sort((a, b) => a - b);
                    }
                    break;
            }
            
            // Display results
            let resultsHTML = '<div class="lotto-balls">';
            
            numbers.forEach(num => {
                resultsHTML += `<div class="ball">${num}</div>`;
            });
            
            resultsHTML += '</div>';
            
            document.getElementById('strategy-results-content').innerHTML = resultsHTML;
            
            // Calculate and display statistics
            const sum = numbers.reduce((a, b) => a + b, 0);
            const avg = sum / numbers.length;
            const oddCount = numbers.filter(n => n % 2 !== 0).length;
            const evenCount = numbers.length - oddCount;
            
            const primes = getPrimesUpTo(mainPool);
            const primeCount = numbers.filter(n => primes.includes(n)).length;
            
            const fibs = getFibonacciUpTo(mainPool);
            const fibCount = numbers.filter(n => fibs.includes(n)).length;
            
            const luckyNumbers = getLuckyNumbers(mainPool);
            const luckyCount = numbers.filter(n => luckyNumbers.includes(n)).length;
            
            const midPoint = Math.floor(mainPool / 2);
            const lowCount = numbers.filter(n => n <= midPoint).length;
            const highCount = numbers.length - lowCount;
            
            let statsHTML = `
                <p><strong>Sum:</strong> ${sum} (Average: ${avg.toFixed(1)})</p>
                <p><strong>Odd/Even:</strong> ${oddCount} odd / ${evenCount} even</p>
                <p><strong>Low/High:</strong> ${lowCount} low / ${highCount} high</p>
                <p><strong>Special Numbers:</strong> ${primeCount} primes, ${fibCount} Fibonacci, ${luckyCount} lucky</p>
            `;
            
            // Add hot/cold stats if available
            const gameHotCold = hotColdData[gameType];
            if (gameHotCold) {
                const hotNumbers = numbers.filter(n => gameHotCold.hot.includes(n)).length;
                const coldNumbers = numbers.filter(n => gameHotCold.cold.includes(n)).length;
                statsHTML += `<p><strong>Hot/Cold:</strong> ${hotNumbers} hot / ${coldNumbers} cold</p>`;
            }
            
            document.getElementById('strategy-statistics-content').innerHTML = statsHTML;
            
            showToast('Numbers generated with strategy', 'success');
        }
        
        // Utility Functions
        function exportToFile(content, filename) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast(`Exported to ${filename}`, 'success');
        }

        function exportToCSV(content, filename) {
            // Convert to CSV format
            const csvContent = content.split('\n')
                .map(line => line.trim())
                .filter(line => line.length > 0)
                .map(line => `"${line.replace(/\s+/g, '", "')}"`)
                .join('\n');
            
            exportToFile(csvContent, filename);
        }
        
        function exportToJSON(content, filename) {
            // Convert to JSON format
            const jsonContent = JSON.stringify(content.split('\n')
                .map(line => line.trim())
                .filter(line => line.length > 0), null, 2);
            
            exportToFile(jsonContent, filename);
        }
        
        function saveLottoConfig() {
            const config = {
                gameType: document.getElementById('lotto-game-type').value,
                algorithm: document.getElementById('lotto-algorithm').value,
                strategy: document.getElementById('lotto-strategy').value,
                multipleValue: document.getElementById('multiple-value').value,
                seed: document.getElementById('lotto-seed').value,
                drawCount: document.getElementById('lotto-draw-count').value,
                mainNumbers: document.getElementById('lotto-main-numbers').value,
                pickNumbers: document.getElementById('lotto-pick-numbers').value,
                bonusNumbers: document.getElementById('lotto-bonus-numbers').value,
                pickBonus: document.getElementById('lotto-pick-bonus').value
            };
            
            localStorage.setItem('lottoConfig', JSON.stringify(config));
            showToast('Lotto configuration saved', 'success');
        }

        function loadLottoConfig() {
            const config = JSON.parse(localStorage.getItem('lottoConfig'));
            if (!config) {
                showToast('No saved configuration found', 'warning');
                return;
            }
            
            document.getElementById('lotto-game-type').value = config.gameType;
            document.getElementById('lotto-algorithm').value = config.algorithm;
            document.getElementById('lotto-strategy').value = config.strategy;
            document.getElementById('multiple-value').value = config.multipleValue;
            document.getElementById('lotto-seed').value = config.seed;
            document.getElementById('lotto-draw-count').value = config.drawCount;
            document.getElementById('lotto-main-numbers').value = config.mainNumbers;
            document.getElementById('lotto-pick-numbers').value = config.pickNumbers;
            document.getElementById('lotto-bonus-numbers').value = config.bonusNumbers;
            document.getElementById('lotto-pick-bonus').value = config.pickBonus;
            
            updateLottoParams();
            updateAlgorithmParams();
            showToast('Lotto configuration loaded', 'success');
        }
        
        function loadSampleHotColdData() {
            // This would normally come from an API or historical data
            // For demo purposes, we'll create some sample data
            hotColdData = {
                powerball: {
                    hot: [23, 32, 61, 53, 69, 16, 28, 42, 19, 58],
                    cold: [1, 2, 66, 67, 68, 5, 10, 15, 20, 25]
                },
                megamillions: {
                    hot: [17, 31, 10, 46, 20, 3, 39, 48, 59, 70],
                    cold: [1, 2, 68, 69, 4, 8, 12, 16, 24, 30]
                },
                euromillions: {
                    hot: [12, 23, 34, 45, 50, 7, 19, 28, 37, 42],
                    cold: [1, 2, 48, 49, 5, 10, 15, 20, 25, 30]
                },
                lotto649: {
                    hot: [7, 14, 21, 28, 35, 42, 49, 6, 13, 20],
                    cold: [1, 2, 47, 48, 3, 8, 12, 16, 24, 30]
                }
            };
        }
        
        // Initialize the application
        window.onload = function() {
            // Set up event listeners for tab switching
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs and contents
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });

            // Initialize theme toggle
            const themeToggle = document.getElementById('themeToggle');
            themeToggle.addEventListener('click', toggleTheme);

            // Check for saved theme preference
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);

            // Initialize parameters display
            updateLottoParams();
            updateAlgorithmParams();
            updateAnalyzer();
            
            // Load sample hot/cold data
            loadSampleHotColdData();
        };

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }
    </script>
</body>
</html>
